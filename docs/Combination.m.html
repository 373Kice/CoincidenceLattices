<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>clattices.Combination API documentation</title>
    <meta name="description" content="" />

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#clattices.Combination.Combination">Combination</a></span>
        
          
  <ul>
    <li class="mono"><a href="#clattices.Combination.Combination.__init__">__init__</a></li>
    <li class="mono"><a href="#clattices.Combination.Combination.findMinimumArea">findMinimumArea</a></li>
    <li class="mono"><a href="#clattices.Combination.Combination.findSolutions">findSolutions</a></li>
    <li class="mono"><a href="#clattices.Combination.Combination.rotationMatrix">rotationMatrix</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#clattices.Combination.Solution">Solution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#clattices.Combination.Solution.__init__">__init__</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#clattices.Combination.Supercell">Supercell</a></span>
        
          
  <ul>
    <li class="mono"><a href="#clattices.Combination.Supercell.__init__">__init__</a></li>
    <li class="mono"><a href="#clattices.Combination.Supercell.calculateAtoms">calculateAtoms</a></li>
    <li class="mono"><a href="#clattices.Combination.Supercell.calculateRelativeArea">calculateRelativeArea</a></li>
    <li class="mono"><a href="#clattices.Combination.Supercell.calculateStrain">calculateStrain</a></li>
    <li class="mono"><a href="#clattices.Combination.Supercell.calculateVectorNorm">calculateVectorNorm</a></li>
    <li class="mono"><a href="#clattices.Combination.Supercell.calculateVectorScaling">calculateVectorScaling</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">clattices.Combination</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination" class="source">
    <div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">clattices_loop</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">class</span> <span class="nc">Solution</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Auxiliary class to solve the equations involving combinations of crystals.</span>
<span class="sd">	A solution is related to an angle and has a list of vectors (m1, m2, n1, n2)</span>
<span class="sd">	which are possible solutions to the coincidence lattice.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initializes the class Solution with the angle.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="p">[]</span>
		
<span class="k">class</span> <span class="nc">Supercell</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Auxiliary class which represents a coincidence lattice. It has all necessary </span>
<span class="sd">	information to describe the coincidence, such as number of atoms inside the supercell,</span>
<span class="sd">	the solution, the area, the constituents etc.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initializes the class Supercell with its relevant information.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">angle</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		The angle which leads to the supercell.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">label_1</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">label</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">label_2</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">label</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Label of the systems creating the supercell.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		The pair of vectors which lead to the supercell.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">vectorScaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateVectorScaling</span> <span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">)</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Derives the scaling of the supercell vectors relative to the first and second crystals</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">vectorNorm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateVectorNorm</span> <span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">)</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Derives the absolute norm of the supercell vectors of the first and second crystals</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">vectorScalingSquared</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorScaling</span><span class="p">]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Derives the square of the scaling of the supercell vectors relative to the first and second crystals.</span>
<span class="sd">		Useful for the Wood notation.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateRelativeArea</span> <span class="p">(</span><span class="n">solutions</span><span class="p">)</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Derives the area of the supercell relative to the first and second crystals</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">nAtoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateAtoms</span> <span class="p">(</span><span class="n">combination</span><span class="p">)</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the number of atoms inside the supercell</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">strain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateStrain</span> <span class="p">()</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the strain necessary to form the system, according to the eq. 12</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
	<span class="k">def</span> <span class="nf">calculateRelativeArea</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the relative area between the unit cell and the supercell.</span>
<span class="sd">		This is done basically by calculating |m x m&#39;|, as well as |n x n&#39;|</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">m1</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">m2</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">m1_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">m2_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="n">n1</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">n2</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
		<span class="n">n1_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">n2_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
		
		<span class="n">area1</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">m2_prime</span> <span class="o">-</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">m2</span>
		<span class="n">area2</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">n2_prime</span> <span class="o">-</span> <span class="n">n1_prime</span><span class="o">*</span><span class="n">n2</span>
			
		<span class="k">return</span> <span class="p">[</span><span class="n">area1</span><span class="p">,</span> <span class="n">area2</span><span class="p">]</span>
	
	<span class="k">def</span> <span class="nf">calculateVectorScaling</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the relative scaling between the unit cell vectors and the supercell vectors.</span>
<span class="sd">		This is done basically by calculating |m1*a1 + m2*a2|, as well as |n1*b1 + n2*b2|</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">A</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
		<span class="n">B</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
		
		<span class="c1"># Recovering the lattice vectors</span>
		<span class="n">a1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">a2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">b1</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">b2</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="c1"># Calculating the strain given the solutions (m1, m2, n1, n2) (solutions[0]) and (m1&#39;, m2&#39;, n1&#39;, n2&#39;) (solutions[1]):</span>
		<span class="n">normA_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
		<span class="n">normA_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
		<span class="n">normB_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span>
		<span class="n">normB_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
			
		<span class="k">return</span> <span class="p">[</span><span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span><span class="p">]</span>
	
	<span class="k">def</span> <span class="nf">calculateVectorNorm</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the absolute scaling of the supercell vectors.</span>
<span class="sd">		This is done basically by calculating |m1*a1 + m2*a2|, as well as |n1*b1 + n2*b2|</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">A</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
		<span class="n">B</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
		
		<span class="c1"># Recovering the lattice vectors</span>
		<span class="n">a1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">a2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">b1</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">b2</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="c1"># Calculating the strain given the solutions (m1, m2, n1, n2) (solutions[0]) and (m1&#39;, m2&#39;, n1&#39;, n2&#39;) (solutions[1]):</span>
		<span class="n">normA_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">normA_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">normB_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
		<span class="n">normB_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
			
		<span class="k">return</span> <span class="p">[</span><span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span><span class="p">]</span>
		
	
	<span class="k">def</span> <span class="nf">calculateAtoms</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the number of atoms inside the supercell.</span>
<span class="sd">		Uses the `areaScaling` variable and the information of the crystals</span>
<span class="sd">		passed by the `Combination` class.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">nAtoms1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">nAtoms</span>
		<span class="n">nAtoms2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">nAtoms</span>
		
		<span class="k">return</span> <span class="n">nAtoms1</span> <span class="o">+</span> <span class="n">nAtoms2</span>
	
	<span class="k">def</span> <span class="nf">calculateStrain</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the strain necessary to form the system, according to the eq. 12</span>
<span class="sd">		Two strains are listed, one for each vector. In the case of hexagonal and square systems, these strains</span>
<span class="sd">		will probably be equal.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNorm</span>
		
		<span class="n">strain1</span> <span class="o">=</span> <span class="p">(</span><span class="n">normB_1</span> <span class="o">-</span> <span class="n">normA_1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normB_1</span> <span class="o">+</span> <span class="n">normA_1</span><span class="p">)</span>
		<span class="n">strain2</span> <span class="o">=</span> <span class="p">(</span><span class="n">normB_2</span> <span class="o">-</span> <span class="n">normA_2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normB_2</span> <span class="o">+</span> <span class="n">normA_2</span><span class="p">)</span>
		
		<span class="k">return</span> <span class="p">[</span><span class="n">strain1</span><span class="p">,</span> <span class="n">strain2</span><span class="p">]</span>
		
		
<span class="k">class</span> <span class="nc">Combination</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Base class for combinations of 2D crystals.</span>
<span class="sd">	</span>
<span class="sd">	By adding to this class two different crystals already described, it is possible to find </span>
<span class="sd">	coincidence lattices within the limits imposed.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crystals</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="n">limits</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initializes the class with the crystals, angles and rules for limiting the size of the supercell</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span> <span class="o">=</span> <span class="n">crystals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span> <span class="o">=</span> <span class="n">crystals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			The two crystals which may form a coincidence lattice</span>
<span class="sd">			&quot;&quot;&quot;</span>
		<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Not enough crystals to describe the combination: two are required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">angles</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			The range of angles to be investigated</span>
<span class="sd">			&quot;&quot;&quot;</span>
		<span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;No angles provided for the combination: at least one is required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
			
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">Nmax</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			The stopping criteria for the calculation</span>
<span class="sd">			&quot;&quot;&quot;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			The maximum strain allowed for determining coincidences</span>
<span class="sd">			&quot;&quot;&quot;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">angle_tolerance</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			Tolerance for approximating angles for the lattice vectors</span>
<span class="sd">			&quot;&quot;&quot;</span>
		<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Limits not enough to calculate the combination: a list [Nmax, tolerance] is required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
			
		
			
		<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		List of all Solutions (m1, m2, n1, n2) of coincidences for the given crystals.</span>
<span class="sd">		&quot;&quot;&quot;</span>
			
		<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		List to find a pair of linearly independent solutions (m1, m2, n1, n2), (m1&#39;, m2&#39;, n1&#39;, n2&#39;)</span>
<span class="sd">		which has minimum area.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">areaUnitCell</span> <span class="o">=</span> <span class="nb">min</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">)))</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Useful information for knowing which is the minimum area allowed for the supercell.</span>
<span class="sd">		&quot;&quot;&quot;</span>		
	
	<span class="k">def</span> <span class="nf">rotationMatrix</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Returns a rotation matrix M (eq. 10) for the given angle in degrees</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span> <span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)],</span>
					  <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)]])</span>
		
		<span class="k">return</span> <span class="n">M</span>
		
	<span class="k">def</span> <span class="nf">findSolutions</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Solves the eq. 11 to find solutions (m1, m2, n1, n2) of coincidences for the given crystals and all angles.</span>
<span class="sd">		All solutions are lists of the type `[[angle_1, solutions_list], [angle_2, solutions_list], ...]`</span>
<span class="sd">		This method calls an extension built in C to speed the calculations, namely `clattices_loop`</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="c1"># Print the lattice into a temporary file for the extension</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s2">&quot;lattices.tmp&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
			<span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="s2"> </span><span class="se">\n</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="s2"> </span><span class="se">\n</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
			
		<span class="c1"># Call the extension</span>
		<span class="n">clattices_loop</span><span class="o">.</span><span class="n">clattices_loop</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_tolerance</span><span class="p">)</span>
		
		<span class="c1"># Read the solutions</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s2">&quot;coincidences.tmp&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">anglesBlock</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
			
			<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">anglesBlock</span><span class="p">:</span>
				<span class="n">lines</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				
				<span class="n">s</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="nb">float</span> <span class="p">(</span><span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
				<span class="k">for</span> <span class="n">eachLine</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">eachLine</span><span class="p">:</span>
						<span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span> <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">eachLine</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">y</span><span class="p">])</span>
				
				<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
		
		<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;lattices.tmp&quot;</span><span class="p">)</span>
		<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;coincidences.tmp&quot;</span><span class="p">)</span>
		
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span>
	
	<span class="k">def</span> <span class="nf">findMinimumArea</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Finds a pair of linearly independent solutions (m1, m2, n1, n2), (m1&#39;, m2&#39;, n1&#39;, n2&#39;)</span>
<span class="sd">		which has minimum area. For each angle, minimizes |m x m&#39;|. </span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">a1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">a2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span><span class="p">:</span>
			
			<span class="n">minArea</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
			<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[]</span>
			
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">)):</span>
				<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">)):</span>
					<span class="n">m1</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
					<span class="n">m2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
					
					<span class="n">m1_prime</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
					<span class="n">m2_prime</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
					
					<span class="n">Am</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">a1</span> <span class="o">+</span> <span class="n">m2</span><span class="o">*</span><span class="n">a2</span>
					<span class="n">Am_prime</span> <span class="o">=</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">a1</span> <span class="o">+</span> <span class="n">m2_prime</span><span class="o">*</span><span class="n">a2</span>
					
					<span class="n">area</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">m2_prime</span> <span class="o">-</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">m2</span>
					
					<span class="n">normAm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Am</span><span class="p">)</span>
					<span class="n">normAm_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Am_prime</span><span class="p">)</span>
					
					<span class="c1"># To prevent rounding errors when using arcsin</span>
					<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Am</span><span class="p">)</span><span class="o">*</span><span class="n">Am_prime</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normAm</span><span class="o">*</span><span class="n">normAm_prime</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">cosAngleVectors</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
						<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="mi">1</span>
					<span class="k">elif</span> <span class="n">cosAngleVectors</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
						<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
						
					<span class="n">angleVectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosAngleVectors</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
					
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">bravaisLattice</span> <span class="o">==</span> <span class="s2">&quot;hexagonal&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">bravaisLattice</span> <span class="o">==</span> <span class="s2">&quot;hexagonal&quot;</span><span class="p">:</span>
						<span class="k">if</span>  <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">area</span> <span class="o">&lt;</span> <span class="n">minArea</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">angleVectors</span> <span class="o">-</span> <span class="mi">60</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">:</span>
							<span class="n">minArea</span> <span class="o">=</span> <span class="n">area</span>
							<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
					<span class="k">elif</span>  <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">area</span> <span class="o">&lt;</span> <span class="n">minArea</span><span class="p">:</span>
						<span class="n">minArea</span> <span class="o">=</span> <span class="n">area</span>
						<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
			
			<span class="k">if</span> <span class="n">minAreaPair</span><span class="p">:</span>
				<span class="n">minAreaSolution</span> <span class="o">=</span> <span class="n">Solution</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
				<span class="n">minAreaSolution</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="n">minAreaPair</span>
				
				<span class="n">cell</span> <span class="o">=</span> <span class="n">Supercell</span> <span class="p">(</span><span class="n">minAreaSolution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">cell</span><span class="p">)</span>
		
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">supercell</span>
		
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="clattices.Combination.Combination" class="name">class <span class="ident">Combination</span></p>
      
  
    <div class="desc"><p>Base class for combinations of 2D crystals.</p>
<p>By adding to this class two different crystals already described, it is possible to find 
coincidence lattices within the limits imposed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Combination', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Combination" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Combination</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Base class for combinations of 2D crystals.</span>
<span class="sd">	</span>
<span class="sd">	By adding to this class two different crystals already described, it is possible to find </span>
<span class="sd">	coincidence lattices within the limits imposed.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crystals</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="n">limits</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initializes the class with the crystals, angles and rules for limiting the size of the supercell</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span> <span class="o">=</span> <span class="n">crystals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span> <span class="o">=</span> <span class="n">crystals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			The two crystals which may form a coincidence lattice</span>
<span class="sd">			&quot;&quot;&quot;</span>
		<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Not enough crystals to describe the combination: two are required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">angles</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			The range of angles to be investigated</span>
<span class="sd">			&quot;&quot;&quot;</span>
		<span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;No angles provided for the combination: at least one is required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
			
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">Nmax</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			The stopping criteria for the calculation</span>
<span class="sd">			&quot;&quot;&quot;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			The maximum strain allowed for determining coincidences</span>
<span class="sd">			&quot;&quot;&quot;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">angle_tolerance</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			Tolerance for approximating angles for the lattice vectors</span>
<span class="sd">			&quot;&quot;&quot;</span>
		<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Limits not enough to calculate the combination: a list [Nmax, tolerance] is required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
			
		
			
		<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		List of all Solutions (m1, m2, n1, n2) of coincidences for the given crystals.</span>
<span class="sd">		&quot;&quot;&quot;</span>
			
		<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		List to find a pair of linearly independent solutions (m1, m2, n1, n2), (m1&#39;, m2&#39;, n1&#39;, n2&#39;)</span>
<span class="sd">		which has minimum area.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">areaUnitCell</span> <span class="o">=</span> <span class="nb">min</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">)))</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Useful information for knowing which is the minimum area allowed for the supercell.</span>
<span class="sd">		&quot;&quot;&quot;</span>		
	
	<span class="k">def</span> <span class="nf">rotationMatrix</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Returns a rotation matrix M (eq. 10) for the given angle in degrees</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span> <span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)],</span>
					  <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)]])</span>
		
		<span class="k">return</span> <span class="n">M</span>
		
	<span class="k">def</span> <span class="nf">findSolutions</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Solves the eq. 11 to find solutions (m1, m2, n1, n2) of coincidences for the given crystals and all angles.</span>
<span class="sd">		All solutions are lists of the type `[[angle_1, solutions_list], [angle_2, solutions_list], ...]`</span>
<span class="sd">		This method calls an extension built in C to speed the calculations, namely `clattices_loop`</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="c1"># Print the lattice into a temporary file for the extension</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s2">&quot;lattices.tmp&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
			<span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="s2"> </span><span class="se">\n</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="s2"> </span><span class="se">\n</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
			
		<span class="c1"># Call the extension</span>
		<span class="n">clattices_loop</span><span class="o">.</span><span class="n">clattices_loop</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_tolerance</span><span class="p">)</span>
		
		<span class="c1"># Read the solutions</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s2">&quot;coincidences.tmp&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">anglesBlock</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
			
			<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">anglesBlock</span><span class="p">:</span>
				<span class="n">lines</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				
				<span class="n">s</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="nb">float</span> <span class="p">(</span><span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
				<span class="k">for</span> <span class="n">eachLine</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">eachLine</span><span class="p">:</span>
						<span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span> <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">eachLine</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">y</span><span class="p">])</span>
				
				<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
		
		<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;lattices.tmp&quot;</span><span class="p">)</span>
		<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;coincidences.tmp&quot;</span><span class="p">)</span>
		
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span>
	
	<span class="k">def</span> <span class="nf">findMinimumArea</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Finds a pair of linearly independent solutions (m1, m2, n1, n2), (m1&#39;, m2&#39;, n1&#39;, n2&#39;)</span>
<span class="sd">		which has minimum area. For each angle, minimizes |m x m&#39;|. </span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">a1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">a2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span><span class="p">:</span>
			
			<span class="n">minArea</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
			<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[]</span>
			
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">)):</span>
				<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">)):</span>
					<span class="n">m1</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
					<span class="n">m2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
					
					<span class="n">m1_prime</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
					<span class="n">m2_prime</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
					
					<span class="n">Am</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">a1</span> <span class="o">+</span> <span class="n">m2</span><span class="o">*</span><span class="n">a2</span>
					<span class="n">Am_prime</span> <span class="o">=</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">a1</span> <span class="o">+</span> <span class="n">m2_prime</span><span class="o">*</span><span class="n">a2</span>
					
					<span class="n">area</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">m2_prime</span> <span class="o">-</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">m2</span>
					
					<span class="n">normAm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Am</span><span class="p">)</span>
					<span class="n">normAm_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Am_prime</span><span class="p">)</span>
					
					<span class="c1"># To prevent rounding errors when using arcsin</span>
					<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Am</span><span class="p">)</span><span class="o">*</span><span class="n">Am_prime</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normAm</span><span class="o">*</span><span class="n">normAm_prime</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">cosAngleVectors</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
						<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="mi">1</span>
					<span class="k">elif</span> <span class="n">cosAngleVectors</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
						<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
						
					<span class="n">angleVectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosAngleVectors</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
					
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">bravaisLattice</span> <span class="o">==</span> <span class="s2">&quot;hexagonal&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">bravaisLattice</span> <span class="o">==</span> <span class="s2">&quot;hexagonal&quot;</span><span class="p">:</span>
						<span class="k">if</span>  <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">area</span> <span class="o">&lt;</span> <span class="n">minArea</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">angleVectors</span> <span class="o">-</span> <span class="mi">60</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">:</span>
							<span class="n">minArea</span> <span class="o">=</span> <span class="n">area</span>
							<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
					<span class="k">elif</span>  <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">area</span> <span class="o">&lt;</span> <span class="n">minArea</span><span class="p">:</span>
						<span class="n">minArea</span> <span class="o">=</span> <span class="n">area</span>
						<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
			
			<span class="k">if</span> <span class="n">minAreaPair</span><span class="p">:</span>
				<span class="n">minAreaSolution</span> <span class="o">=</span> <span class="n">Solution</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
				<span class="n">minAreaSolution</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="n">minAreaPair</span>
				
				<span class="n">cell</span> <span class="o">=</span> <span class="n">Supercell</span> <span class="p">(</span><span class="n">minAreaSolution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">cell</span><span class="p">)</span>
		
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">supercell</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#clattices.Combination.Combination">Combination</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Combination.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, crystals, angles, limits)</p>
    </div>
    

    
  
    <div class="desc"><p>Initializes the class with the crystals, angles and rules for limiting the size of the supercell</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Combination.__init__', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Combination.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crystals</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="n">limits</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initializes the class with the crystals, angles and rules for limiting the size of the supercell</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span> <span class="o">=</span> <span class="n">crystals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span> <span class="o">=</span> <span class="n">crystals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		The two crystals which may form a coincidence lattice</span>
<span class="sd">		&quot;&quot;&quot;</span>
	<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Not enough crystals to describe the combination: two are required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">angles</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		The range of angles to be investigated</span>
<span class="sd">		&quot;&quot;&quot;</span>
	<span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;No angles provided for the combination: at least one is required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
		
	<span class="k">try</span><span class="p">:</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">Nmax</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		The stopping criteria for the calculation</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		The maximum strain allowed for determining coincidences</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">angle_tolerance</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Tolerance for approximating angles for the lattice vectors</span>
<span class="sd">		&quot;&quot;&quot;</span>
	<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Limits not enough to calculate the combination: a list [Nmax, tolerance] is required</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
		
	
		
	<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	List of all Solutions (m1, m2, n1, n2) of coincidences for the given crystals.</span>
<span class="sd">	&quot;&quot;&quot;</span>
		
	<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	List to find a pair of linearly independent solutions (m1, m2, n1, n2), (m1&#39;, m2&#39;, n1&#39;, n2&#39;)</span>
<span class="sd">	which has minimum area.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">areaUnitCell</span> <span class="o">=</span> <span class="nb">min</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">)))</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Useful information for knowing which is the minimum area allowed for the supercell.</span>
<span class="sd">	&quot;&quot;&quot;</span>		
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Combination.findMinimumArea">
    <p>def <span class="ident">findMinimumArea</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Finds a pair of linearly independent solutions (m1, m2, n1, n2), (m1', m2', n1', n2')
which has minimum area. For each angle, minimizes |m x m'|.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Combination.findMinimumArea', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Combination.findMinimumArea" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">findMinimumArea</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Finds a pair of linearly independent solutions (m1, m2, n1, n2), (m1&#39;, m2&#39;, n1&#39;, n2&#39;)</span>
<span class="sd">	which has minimum area. For each angle, minimizes |m x m&#39;|. </span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">a1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">a2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span><span class="p">:</span>
		
		<span class="n">minArea</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
		<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">)):</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">)):</span>
				<span class="n">m1</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">m2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
				
				<span class="n">m1_prime</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">m2_prime</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
				
				<span class="n">Am</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">a1</span> <span class="o">+</span> <span class="n">m2</span><span class="o">*</span><span class="n">a2</span>
				<span class="n">Am_prime</span> <span class="o">=</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">a1</span> <span class="o">+</span> <span class="n">m2_prime</span><span class="o">*</span><span class="n">a2</span>
				
				<span class="n">area</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">m2_prime</span> <span class="o">-</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">m2</span>
				
				<span class="n">normAm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Am</span><span class="p">)</span>
				<span class="n">normAm_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Am_prime</span><span class="p">)</span>
				
				<span class="c1"># To prevent rounding errors when using arcsin</span>
				<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Am</span><span class="p">)</span><span class="o">*</span><span class="n">Am_prime</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normAm</span><span class="o">*</span><span class="n">normAm_prime</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">cosAngleVectors</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">elif</span> <span class="n">cosAngleVectors</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
					<span class="n">cosAngleVectors</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
					
				<span class="n">angleVectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosAngleVectors</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
				
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">bravaisLattice</span> <span class="o">==</span> <span class="s2">&quot;hexagonal&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">bravaisLattice</span> <span class="o">==</span> <span class="s2">&quot;hexagonal&quot;</span><span class="p">:</span>
					<span class="k">if</span>  <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">area</span> <span class="o">&lt;</span> <span class="n">minArea</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">angleVectors</span> <span class="o">-</span> <span class="mi">60</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">:</span>
						<span class="n">minArea</span> <span class="o">=</span> <span class="n">area</span>
						<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
				<span class="k">elif</span>  <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">area</span> <span class="o">&lt;</span> <span class="n">minArea</span><span class="p">:</span>
					<span class="n">minArea</span> <span class="o">=</span> <span class="n">area</span>
					<span class="n">minAreaPair</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
		
		<span class="k">if</span> <span class="n">minAreaPair</span><span class="p">:</span>
			<span class="n">minAreaSolution</span> <span class="o">=</span> <span class="n">Solution</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
			<span class="n">minAreaSolution</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="n">minAreaPair</span>
			
			<span class="n">cell</span> <span class="o">=</span> <span class="n">Supercell</span> <span class="p">(</span><span class="n">minAreaSolution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">supercell</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">cell</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">supercell</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Combination.findSolutions">
    <p>def <span class="ident">findSolutions</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Solves the eq. 11 to find solutions (m1, m2, n1, n2) of coincidences for the given crystals and all angles.
All solutions are lists of the type <code>[[angle_1, solutions_list], [angle_2, solutions_list], ...]</code>
This method calls an extension built in C to speed the calculations, namely <code>clattices_loop</code></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Combination.findSolutions', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Combination.findSolutions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">findSolutions</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Solves the eq. 11 to find solutions (m1, m2, n1, n2) of coincidences for the given crystals and all angles.</span>
<span class="sd">	All solutions are lists of the type `[[angle_1, solutions_list], [angle_2, solutions_list], ...]`</span>
<span class="sd">	This method calls an extension built in C to speed the calculations, namely `clattices_loop`</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span> <span class="o">=</span> <span class="p">[]</span>
	
	<span class="c1"># Print the lattice into a temporary file for the extension</span>
	<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s2">&quot;lattices.tmp&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
		<span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
		<span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="s2"> </span><span class="se">\n</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">A</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="s2"> </span><span class="se">\n</span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
		
	<span class="c1"># Call the extension</span>
	<span class="n">clattices_loop</span><span class="o">.</span><span class="n">clattices_loop</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_tolerance</span><span class="p">)</span>
	
	<span class="c1"># Read the solutions</span>
	<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s2">&quot;coincidences.tmp&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
		<span class="n">anglesBlock</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
		
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">anglesBlock</span><span class="p">:</span>
			<span class="n">lines</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			
			<span class="n">s</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="nb">float</span> <span class="p">(</span><span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
			<span class="k">for</span> <span class="n">eachLine</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">eachLine</span><span class="p">:</span>
					<span class="n">s</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span> <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">eachLine</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">y</span><span class="p">])</span>
			
			<span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
	
	<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;lattices.tmp&quot;</span><span class="p">)</span>
	<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;coincidences.tmp&quot;</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">allSolutions</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Combination.rotationMatrix">
    <p>def <span class="ident">rotationMatrix</span>(</p><p>self, angle)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a rotation matrix M (eq. 10) for the given angle in degrees</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Combination.rotationMatrix', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Combination.rotationMatrix" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rotationMatrix</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Returns a rotation matrix M (eq. 10) for the given angle in degrees</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span> <span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)],</span>
				  <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span> <span class="p">(</span><span class="n">angle</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)]])</span>
	
	<span class="k">return</span> <span class="n">M</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="clattices.Combination.Combination.allSolutions" class="name">var <span class="ident">allSolutions</span></p>
            

            
  
    <div class="desc"><p>List of all Solutions (m1, m2, n1, n2) of coincidences for the given crystals.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Combination.areaUnitCell" class="name">var <span class="ident">areaUnitCell</span></p>
            

            
  
    <div class="desc"><p>Useful information for knowing which is the minimum area allowed for the supercell.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Combination.supercell" class="name">var <span class="ident">supercell</span></p>
            

            
  
    <div class="desc"><p>List to find a pair of linearly independent solutions (m1, m2, n1, n2), (m1', m2', n1', n2')
which has minimum area.</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="clattices.Combination.Solution" class="name">class <span class="ident">Solution</span></p>
      
  
    <div class="desc"><p>Auxiliary class to solve the equations involving combinations of crystals.
A solution is related to an angle and has a list of vectors (m1, m2, n1, n2)
which are possible solutions to the coincidence lattice.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Solution', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Solution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Solution</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Auxiliary class to solve the equations involving combinations of crystals.</span>
<span class="sd">	A solution is related to an angle and has a list of vectors (m1, m2, n1, n2)</span>
<span class="sd">	which are possible solutions to the coincidence lattice.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initializes the class Solution with the angle.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#clattices.Combination.Solution">Solution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Solution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, angle)</p>
    </div>
    

    
  
    <div class="desc"><p>Initializes the class Solution with the angle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Solution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Solution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initializes the class Solution with the angle.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="clattices.Combination.Solution.angle" class="name">var <span class="ident">angle</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Solution.solutions" class="name">var <span class="ident">solutions</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="clattices.Combination.Supercell" class="name">class <span class="ident">Supercell</span></p>
      
  
    <div class="desc"><p>Auxiliary class which represents a coincidence lattice. It has all necessary 
information to describe the coincidence, such as number of atoms inside the supercell,
the solution, the area, the constituents etc.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Supercell', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Supercell" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Supercell</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Auxiliary class which represents a coincidence lattice. It has all necessary </span>
<span class="sd">	information to describe the coincidence, such as number of atoms inside the supercell,</span>
<span class="sd">	the solution, the area, the constituents etc.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initializes the class Supercell with its relevant information.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">angle</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		The angle which leads to the supercell.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">label_1</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">label</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">label_2</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">label</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Label of the systems creating the supercell.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		The pair of vectors which lead to the supercell.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">vectorScaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateVectorScaling</span> <span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">)</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Derives the scaling of the supercell vectors relative to the first and second crystals</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">vectorNorm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateVectorNorm</span> <span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">)</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Derives the absolute norm of the supercell vectors of the first and second crystals</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">vectorScalingSquared</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorScaling</span><span class="p">]</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Derives the square of the scaling of the supercell vectors relative to the first and second crystals.</span>
<span class="sd">		Useful for the Wood notation.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateRelativeArea</span> <span class="p">(</span><span class="n">solutions</span><span class="p">)</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Derives the area of the supercell relative to the first and second crystals</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">nAtoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateAtoms</span> <span class="p">(</span><span class="n">combination</span><span class="p">)</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the number of atoms inside the supercell</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">strain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateStrain</span> <span class="p">()</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the strain necessary to form the system, according to the eq. 12</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
	<span class="k">def</span> <span class="nf">calculateRelativeArea</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the relative area between the unit cell and the supercell.</span>
<span class="sd">		This is done basically by calculating |m x m&#39;|, as well as |n x n&#39;|</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">m1</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">m2</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">m1_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">m2_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="n">n1</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">n2</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
		<span class="n">n1_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">n2_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
		
		<span class="n">area1</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">m2_prime</span> <span class="o">-</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">m2</span>
		<span class="n">area2</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">n2_prime</span> <span class="o">-</span> <span class="n">n1_prime</span><span class="o">*</span><span class="n">n2</span>
			
		<span class="k">return</span> <span class="p">[</span><span class="n">area1</span><span class="p">,</span> <span class="n">area2</span><span class="p">]</span>
	
	<span class="k">def</span> <span class="nf">calculateVectorScaling</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the relative scaling between the unit cell vectors and the supercell vectors.</span>
<span class="sd">		This is done basically by calculating |m1*a1 + m2*a2|, as well as |n1*b1 + n2*b2|</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">A</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
		<span class="n">B</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
		
		<span class="c1"># Recovering the lattice vectors</span>
		<span class="n">a1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">a2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">b1</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">b2</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="c1"># Calculating the strain given the solutions (m1, m2, n1, n2) (solutions[0]) and (m1&#39;, m2&#39;, n1&#39;, n2&#39;) (solutions[1]):</span>
		<span class="n">normA_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
		<span class="n">normA_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
		<span class="n">normB_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span>
		<span class="n">normB_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
			
		<span class="k">return</span> <span class="p">[</span><span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span><span class="p">]</span>
	
	<span class="k">def</span> <span class="nf">calculateVectorNorm</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the absolute scaling of the supercell vectors.</span>
<span class="sd">		This is done basically by calculating |m1*a1 + m2*a2|, as well as |n1*b1 + n2*b2|</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">A</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
		<span class="n">B</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
		
		<span class="c1"># Recovering the lattice vectors</span>
		<span class="n">a1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">a2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">b1</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">b2</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="c1"># Calculating the strain given the solutions (m1, m2, n1, n2) (solutions[0]) and (m1&#39;, m2&#39;, n1&#39;, n2&#39;) (solutions[1]):</span>
		<span class="n">normA_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">normA_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">normB_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
		<span class="n">normB_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
			
		<span class="k">return</span> <span class="p">[</span><span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span><span class="p">]</span>
		
	
	<span class="k">def</span> <span class="nf">calculateAtoms</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the number of atoms inside the supercell.</span>
<span class="sd">		Uses the `areaScaling` variable and the information of the crystals</span>
<span class="sd">		passed by the `Combination` class.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">nAtoms1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">nAtoms</span>
		<span class="n">nAtoms2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">nAtoms</span>
		
		<span class="k">return</span> <span class="n">nAtoms1</span> <span class="o">+</span> <span class="n">nAtoms2</span>
	
	<span class="k">def</span> <span class="nf">calculateStrain</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculates the strain necessary to form the system, according to the eq. 12</span>
<span class="sd">		Two strains are listed, one for each vector. In the case of hexagonal and square systems, these strains</span>
<span class="sd">		will probably be equal.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNorm</span>
		
		<span class="n">strain1</span> <span class="o">=</span> <span class="p">(</span><span class="n">normB_1</span> <span class="o">-</span> <span class="n">normA_1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normB_1</span> <span class="o">+</span> <span class="n">normA_1</span><span class="p">)</span>
		<span class="n">strain2</span> <span class="o">=</span> <span class="p">(</span><span class="n">normB_2</span> <span class="o">-</span> <span class="n">normA_2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normB_2</span> <span class="o">+</span> <span class="n">normA_2</span><span class="p">)</span>
		
		<span class="k">return</span> <span class="p">[</span><span class="n">strain1</span><span class="p">,</span> <span class="n">strain2</span><span class="p">]</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#clattices.Combination.Supercell">Supercell</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Supercell.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, solutions, combination)</p>
    </div>
    

    
  
    <div class="desc"><p>Initializes the class Supercell with its relevant information.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Supercell.__init__', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Supercell.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initializes the class Supercell with its relevant information.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">angle</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	The angle which leads to the supercell.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">label_1</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">label</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">label_2</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">label</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Label of the systems creating the supercell.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	The pair of vectors which lead to the supercell.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">vectorScaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateVectorScaling</span> <span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">)</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Derives the scaling of the supercell vectors relative to the first and second crystals</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">vectorNorm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateVectorNorm</span> <span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">)</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Derives the absolute norm of the supercell vectors of the first and second crystals</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">vectorScalingSquared</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorScaling</span><span class="p">]</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Derives the square of the scaling of the supercell vectors relative to the first and second crystals.</span>
<span class="sd">	Useful for the Wood notation.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateRelativeArea</span> <span class="p">(</span><span class="n">solutions</span><span class="p">)</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Derives the area of the supercell relative to the first and second crystals</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">nAtoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateAtoms</span> <span class="p">(</span><span class="n">combination</span><span class="p">)</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculates the number of atoms inside the supercell</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">strain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateStrain</span> <span class="p">()</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculates the strain necessary to form the system, according to the eq. 12</span>
<span class="sd">	&quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Supercell.calculateAtoms">
    <p>def <span class="ident">calculateAtoms</span>(</p><p>self, combination)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates the number of atoms inside the supercell.
Uses the <code>areaScaling</code> variable and the information of the crystals
passed by the <code>Combination</code> class.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Supercell.calculateAtoms', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Supercell.calculateAtoms" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculateAtoms</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculates the number of atoms inside the supercell.</span>
<span class="sd">	Uses the `areaScaling` variable and the information of the crystals</span>
<span class="sd">	passed by the `Combination` class.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">nAtoms1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">nAtoms</span>
	<span class="n">nAtoms2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areaScaling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">nAtoms</span>
	
	<span class="k">return</span> <span class="n">nAtoms1</span> <span class="o">+</span> <span class="n">nAtoms2</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Supercell.calculateRelativeArea">
    <p>def <span class="ident">calculateRelativeArea</span>(</p><p>self, solutions)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates the relative area between the unit cell and the supercell.
This is done basically by calculating |m x m'|, as well as |n x n'|</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Supercell.calculateRelativeArea', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Supercell.calculateRelativeArea" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculateRelativeArea</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculates the relative area between the unit cell and the supercell.</span>
<span class="sd">	This is done basically by calculating |m x m&#39;|, as well as |n x n&#39;|</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">m1</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">m2</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">m1_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">m2_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
	
	<span class="n">n1</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
	<span class="n">n2</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
	<span class="n">n1_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
	<span class="n">n2_prime</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
	
	<span class="n">area1</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">m2_prime</span> <span class="o">-</span> <span class="n">m1_prime</span><span class="o">*</span><span class="n">m2</span>
	<span class="n">area2</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">n2_prime</span> <span class="o">-</span> <span class="n">n1_prime</span><span class="o">*</span><span class="n">n2</span>
		
	<span class="k">return</span> <span class="p">[</span><span class="n">area1</span><span class="p">,</span> <span class="n">area2</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Supercell.calculateStrain">
    <p>def <span class="ident">calculateStrain</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates the strain necessary to form the system, according to the eq. 12
Two strains are listed, one for each vector. In the case of hexagonal and square systems, these strains
will probably be equal.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Supercell.calculateStrain', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Supercell.calculateStrain" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculateStrain</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculates the strain necessary to form the system, according to the eq. 12</span>
<span class="sd">	Two strains are listed, one for each vector. In the case of hexagonal and square systems, these strains</span>
<span class="sd">	will probably be equal.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorNorm</span>
	
	<span class="n">strain1</span> <span class="o">=</span> <span class="p">(</span><span class="n">normB_1</span> <span class="o">-</span> <span class="n">normA_1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normB_1</span> <span class="o">+</span> <span class="n">normA_1</span><span class="p">)</span>
	<span class="n">strain2</span> <span class="o">=</span> <span class="p">(</span><span class="n">normB_2</span> <span class="o">-</span> <span class="n">normA_2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">normB_2</span> <span class="o">+</span> <span class="n">normA_2</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="p">[</span><span class="n">strain1</span><span class="p">,</span> <span class="n">strain2</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Supercell.calculateVectorNorm">
    <p>def <span class="ident">calculateVectorNorm</span>(</p><p>self, solutions, combination)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates the absolute scaling of the supercell vectors.
This is done basically by calculating |m1<em>a1 + m2</em>a2|, as well as |n1<em>b1 + n2</em>b2|</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Supercell.calculateVectorNorm', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Supercell.calculateVectorNorm" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculateVectorNorm</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculates the absolute scaling of the supercell vectors.</span>
<span class="sd">	This is done basically by calculating |m1*a1 + m2*a2|, as well as |n1*b1 + n2*b2|</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">A</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
	<span class="n">B</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
	
	<span class="c1"># Recovering the lattice vectors</span>
	<span class="n">a1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">a2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">b1</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">b2</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
	
	<span class="c1"># Calculating the strain given the solutions (m1, m2, n1, n2) (solutions[0]) and (m1&#39;, m2&#39;, n1&#39;, n2&#39;) (solutions[1]):</span>
	<span class="n">normA_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">normA_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">normB_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
	<span class="n">normB_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
		
	<span class="k">return</span> <span class="p">[</span><span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="clattices.Combination.Supercell.calculateVectorScaling">
    <p>def <span class="ident">calculateVectorScaling</span>(</p><p>self, solutions, combination)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates the relative scaling between the unit cell vectors and the supercell vectors.
This is done basically by calculating |m1<em>a1 + m2</em>a2|, as well as |n1<em>b1 + n2</em>b2|</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-clattices.Combination.Supercell.calculateVectorScaling', this);">Show source &equiv;</a></p>
  <div id="source-clattices.Combination.Supercell.calculateVectorScaling" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculateVectorScaling</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculates the relative scaling between the unit cell vectors and the supercell vectors.</span>
<span class="sd">	This is done basically by calculating |m1*a1 + m2*a2|, as well as |n1*b1 + n2*b2|</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">A</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_1</span><span class="o">.</span><span class="n">latticeVectors</span>
	<span class="n">B</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">crystal_2</span><span class="o">.</span><span class="n">latticeVectors</span>
	
	<span class="c1"># Recovering the lattice vectors</span>
	<span class="n">a1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">a2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">b1</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">b2</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
	
	<span class="c1"># Calculating the strain given the solutions (m1, m2, n1, n2) (solutions[0]) and (m1&#39;, m2&#39;, n1&#39;, n2&#39;) (solutions[1]):</span>
	<span class="n">normA_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
	<span class="n">normA_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
	<span class="n">normB_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span>
	<span class="n">normB_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">solutions</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
		
	<span class="k">return</span> <span class="p">[</span><span class="n">normA_1</span><span class="p">,</span> <span class="n">normA_2</span><span class="p">,</span> <span class="n">normB_1</span><span class="p">,</span> <span class="n">normB_2</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="clattices.Combination.Supercell.angle" class="name">var <span class="ident">angle</span></p>
            

            
  
    <div class="desc"><p>The angle which leads to the supercell.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.areaScaling" class="name">var <span class="ident">areaScaling</span></p>
            

            
  
    <div class="desc"><p>Derives the area of the supercell relative to the first and second crystals</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.label_1" class="name">var <span class="ident">label_1</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.label_2" class="name">var <span class="ident">label_2</span></p>
            

            
  
    <div class="desc"><p>Label of the systems creating the supercell.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.nAtoms" class="name">var <span class="ident">nAtoms</span></p>
            

            
  
    <div class="desc"><p>Calculates the number of atoms inside the supercell</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.solutions" class="name">var <span class="ident">solutions</span></p>
            

            
  
    <div class="desc"><p>The pair of vectors which lead to the supercell.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.strain" class="name">var <span class="ident">strain</span></p>
            

            
  
    <div class="desc"><p>Calculates the strain necessary to form the system, according to the eq. 12</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.vectorNorm" class="name">var <span class="ident">vectorNorm</span></p>
            

            
  
    <div class="desc"><p>Derives the absolute norm of the supercell vectors of the first and second crystals</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.vectorScaling" class="name">var <span class="ident">vectorScaling</span></p>
            

            
  
    <div class="desc"><p>Derives the scaling of the supercell vectors relative to the first and second crystals</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="clattices.Combination.Supercell.vectorScalingSquared" class="name">var <span class="ident">vectorScalingSquared</span></p>
            

            
  
    <div class="desc"><p>Derives the square of the scaling of the supercell vectors relative to the first and second crystals.
Useful for the Wood notation.</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
